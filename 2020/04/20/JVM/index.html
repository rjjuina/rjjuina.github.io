<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>JVM | 务虚之城</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="JVM is an abstract virtual machine(program) which is could be installed on any device or operating systems. One good explaination of JVM Architecture   to provide runtime environment to execute other">
<meta property="og:type" content="article">
<meta property="og:title" content="JVM">
<meta property="og:url" content="https://jjuina.com/2020/04/20/JVM/index.html">
<meta property="og:site_name" content="务虚之城">
<meta property="og:description" content="JVM is an abstract virtual machine(program) which is could be installed on any device or operating systems. One good explaination of JVM Architecture   to provide runtime environment to execute other">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://images.idgesg.net/images/article/2019/03/javaworld_jvm_jdk_jre_explainer_java_virtual_machine_debug_and_optimize_3x2_overview_update-100790558-orig.jpg">
<meta property="og:image" content="https://www.javacodegeeks.com/wp-content/uploads/2018/04/jvm_archi_clrda_guide_5.jpg">
<meta property="og:image" content="https://java2blog.com/wp-content/uploads/2019/05/YoungOldGeneration-1024x733.png">
<meta property="article:published_time" content="2020-04-19T16:00:00.000Z">
<meta property="article:modified_time" content="2020-04-20T08:10:43.049Z">
<meta property="article:author" content="Roy Jia">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://images.idgesg.net/images/article/2019/03/javaworld_jvm_jdk_jre_explainer_java_virtual_machine_debug_and_optimize_3x2_overview_update-100790558-orig.jpg">
  
    <link rel="alternate" href="/atom.xml" title="务虚之城" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
  
  
<link rel="stylesheet" href="/css/style.css">

  

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://jjuina.com"></form>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">HomePage</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">务虚之城</a>
      </h1>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-JVM" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/20/JVM/" class="article-date">
  <time datetime="2020-04-19T16:00:00.000Z" itemprop="datePublished">2020-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      JVM
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>JVM is an abstract virtual machine(program) which is could be installed on any device or operating systems. One good explaination of <a href="https://www.youtube.com/watch?v=QHIWkwxs0AI" target="_blank" rel="noopener">JVM Architecture</a></p>
<p><img src="https://images.idgesg.net/images/article/2019/03/javaworld_jvm_jdk_jre_explainer_java_virtual_machine_debug_and_optimize_3x2_overview_update-100790558-orig.jpg" alt="app-jvm-platforms"></p>
<ul>
<li>to provide runtime environment to execute other programs(Java application).</li>
<li>to manage and optimize program memory.</li>
</ul>
<h2 id="Modules-that-JVM-has"><a href="#Modules-that-JVM-has" class="headerlink" title="Modules that JVM has"></a>Modules that JVM has</h2><ul>
<li>Class Loader</li>
<li>Memory Area - Allocated by JVM<ul>
<li>Class Area</li>
<li>Heap</li>
<li>Stack</li>
<li>PC Registor</li>
<li>Native Method Stack</li>
</ul>
</li>
<li>Execution Engine</li>
</ul>
<h3 id="ClassLoader"><a href="#ClassLoader" class="headerlink" title="ClassLoader"></a>ClassLoader</h3><p>ClassLoader is a subsystem of JVM which is used to load class files, whenever we run the java program, it is loaded first by ClassLoader.</p>
<ul>
<li>Loading - This component loads <code>.class</code> files form the hardware system into the JVM memory and stores the binary data(such as qualified class-name, immediate parent class-name, constructor info, method info, variables etc.) into Class(Method) Area.<ul>
<li>Bootstrap ClassLoader - This is the first ClassLoader which is the super Class of extension ClassLoader, to load rt.jar(run time) which contains all class files of Java Standard Edition like java.lang.*; java.io.*; java.util.*;</li>
<li>Extension ClassLoader - This is the sub ClassLoader of Bootstrap ClassLoader and the parent ClassLoader of application ClassLoader to load class files which are located inside $JAVA_HOME/jre/lib/ext directory.</li>
<li>System / Application ClassLoader - This is the sub ClassLoader of Extension ClassLoader to load Java app class files. It loads the class files from classpath, by default, it’s currrent directory. the classpath could be change by <code>-cp</code> or <code>-classpath</code>.</li>
</ul>
</li>
<li>Linking - This component performs the linking of a class or an interface. As it involves the allocation if new date structure, it may throw <code>outOfMemoryError</code> and performs 3 important activities.<ul>
<li>Verification - This process if performed by Bytecode verifier and if the generated <code>.class</code> file is not valid, then throw <code>VerifyError</code>.</li>
<li>Preparation - This is the process of assigning the memory for the class level or interface level static variables and assigns the default value.</li>
<li>Resolution - This is the process of changing the symbolic references with the original memory references from the Class(Method) Area.</li>
</ul>
</li>
<li>Initialization - This component performs the last phase of class loading where all the static variables are assigned the original values and the static blocks are executed from parent to child class. This process requires care synchronization as JVM is multithreaded and some threads may try to initialize the same class or interface at the same time.</li>
</ul>
<h3 id="Runtime-Data-Areas"><a href="#Runtime-Data-Areas" class="headerlink" title="Runtime Data Areas"></a>Runtime Data Areas</h3><p>Memory management system of JVM, it is used to store Class info, instance info, method info, constants or variables.</p>
<p><img src="https://www.javacodegeeks.com/wp-content/uploads/2018/04/jvm_archi_clrda_guide_5.jpg" alt="JVM-runtime-data-areas"></p>
<h4 id="Class-Method-Area"><a href="#Class-Method-Area" class="headerlink" title="Class(Method) Area"></a>Class(Method) Area</h4><p>ClassLoader loads the <code>.class</code> files and save bytecode in the Class(Method) area. This </p>
<h4 id="Heap"><a href="#Heap" class="headerlink" title="Heap"></a>Heap</h4><p>JVM heap is a part of JVM memory where all the objects and it’s corresponding instance variables and arrays are stored. There is only one heap area and is shared across multiple threads as the data stored here is not thread-safe.</p>
<h4 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a>Stack</h4><p>JVM Stack is a part of JVM memory where all temporary variables are stored, this area has stack frames and allocates one frame for each thread, once the thread execution is completed, the frame also gets destroyed. This component is thread-safe.</p>
<h4 id="PC-Program-Counter-Regiser"><a href="#PC-Program-Counter-Regiser" class="headerlink" title="PC(Program Counter) Regiser"></a>PC(Program Counter) Regiser</h4><p>This component holds the address of JVM instruction which is currently executing, each Java thread has its own PC register to hold the address of the current executing instruction. Which means this component is thread-safe.</p>
<h4 id="Native-Method-Stack"><a href="#Native-Method-Stack" class="headerlink" title="Native Method Stack"></a>Native Method Stack</h4><p>This component is written in different language and holds the native method info, each Java thread has a separate native method stack, which means that this component is thread-safe.</p>
<p>There are 2 exceptional condition is associated with this area:</p>
<ul>
<li>If the program requires more native method stack than it’s permissible limit, the JVM throws <code>StackOverflow</code> error.</li>
<li>If the native method stack is insufficiently expanded, the JVM throws <code>OutOfMemory</code> error.</li>
</ul>
<h3 id="Execution-Engine"><a href="#Execution-Engine" class="headerlink" title="Execution Engine"></a>Execution Engine</h3><p>This component executes the bytecode which is assigned to runtime data area and it has 3 main sub-components</p>
<ul>
<li>Interpreter - this component reads the bytecode instructions and executes them in sequential manner</li>
<li>JIT(Just In Time) compiler - this component counterbalances Interpreters’s disadvantage of slow execution and improves the performance</li>
<li>Garbage Collection - this component frees up the memeory by collecting and removing the unreferenced objects</li>
</ul>
<h4 id="Garbage-Collection"><a href="#Garbage-Collection" class="headerlink" title="Garbage Collection"></a>Garbage Collection</h4><p>Garbage collection is the process of identifying used and unused objects on Java heap and removing unused object from the heap.<br>A live object means an object is still referred to some part of program. Unused object means object is not being referred by any part of program and is eligible for garbage collection.<br>Programmer does not have to do manual garbage collection like C or C++. Java take care of it.</p>
<p>JVM memory is devided to three parts</p>
<ul>
<li>Young generation</li>
<li>Old generation</li>
<li>Metaspace (Perm Gen)</li>
</ul>
<h5 id="Young-Generation"><a href="#Young-Generation" class="headerlink" title="Young Generation"></a>Young Generation</h5><p>As the name suggests, young generation is the area where newly created objects are allocated.</p>
<ul>
<li>When Young Generation fills up, it cause minor garbage collection aka Minor GC.</li>
<li>When Minor GC occurs, the dead objects will be removed from Young Generation.</li>
<li>If you have lots of dead objects in Young Generation, Minor GC will be performed faster.</li>
<li>All Minor GCs are “stop the world” events, so when Minor GCs occurs, application thread will also stop.</li>
</ul>
<p><img src="https://java2blog.com/wp-content/uploads/2019/05/YoungOldGeneration-1024x733.png" alt="Young and Old generation"></p>
<h5 id="Old-Generation"><a href="#Old-Generation" class="headerlink" title="Old Generation"></a>Old Generation</h5><ul>
<li>It is used to hold old long surviving objexts.</li>
<li>It is generally lager than the Young Generation.</li>
<li>When tenured space is completely filled(or predefined threshold) with objects then Major GC occur. It will reclaim the memory and free up the space.</li>
<li>Often, Major GCs are slower and less frequent than Minor GC.</li>
</ul>
<h5 id="Garbage-Collection-Algorithms"><a href="#Garbage-Collection-Algorithms" class="headerlink" title="Garbage Collection Algorithms"></a>Garbage Collection Algorithms</h5><h6 id="serial-collector"><a href="#serial-collector" class="headerlink" title="serial collector"></a>serial collector</h6><p>It uses single thread to perform all the garbage collection and is suitable for basic application with single processor machines.</p>
<h6 id="Parallel-collector"><a href="#Parallel-collector" class="headerlink" title="Parallel collector"></a>Parallel collector</h6><p>It uses multiple CPUs to perform garbage collector. While serial collector uses 1 thread to perform GC, parallel GC uses several threads to perform GC and it is useful when there is enough memory and good number of cores.</p>
<h6 id="Concurrent-collector"><a href="#Concurrent-collector" class="headerlink" title="Concurrent collector"></a>Concurrent collector</h6><p>Concurrent collector performs garbage collection with application threads. It is useful for applications which have medium to large datasets and require quick response time.</p>
<h3 id="Native-Method-Interface-JNI-Java-Native-Interface"><a href="#Native-Method-Interface-JNI-Java-Native-Interface" class="headerlink" title="Native Method Interface (JNI - Java Native Interface)"></a>Native Method Interface (JNI - Java Native Interface)</h3><p>This component is a programming framework that allows Java code to call or be called by the libraries and the native application(the programs specific to the hardware or the OS of the system)</p>
<h3 id="Native-Method-Libraries"><a href="#Native-Method-Libraries" class="headerlink" title="Native Method Libraries"></a>Native Method Libraries</h3><p>This component is a collection of native C, C++ libraries which are required by the execution engine.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a href="https://www.javacodegeeks.com/2018/04/jvm-architecture-overview-of-jvm-and-jvm-architecture.html" target="_blank" rel="noopener">https://www.javacodegeeks.com/2018/04/jvm-architecture-overview-of-jvm-and-jvm-architecture.html</a></li>
<li><a href="https://www.javacodegeeks.com/2018/04/jvm-architecture-jvm-class-loader-and-runtime-data-areas.html" target="_blank" rel="noopener">https://www.javacodegeeks.com/2018/04/jvm-architecture-jvm-class-loader-and-runtime-data-areas.html</a></li>
<li><a href="https://www.javatpoint.com/jvm-java-virtual-machine" target="_blank" rel="noopener">https://www.javatpoint.com/jvm-java-virtual-machine</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://jjuina.com/2020/04/20/JVM/" data-id="ck987ca3500099turf1at0w1n" class="article-share-link">Share</a>
      
      
        <a href="https://jjuina.com/2020/04/20/JVM/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li></ul>

    </footer>
  </div>
  
    
 
<script src="/jquery/jquery.min.js"></script>

  <div id="random_posts">
    <h2>Recommended Posts</h2>
    <div class="random_posts_ul">
      <script>
          var random_count =4
          var site = {BASE_URI:'/'};
          function load_random_posts(obj) {
              var arr=site.posts;
              if (!obj) return;
              // var count = $(obj).attr('data-count') || 6;
              for (var i, tmp, n = arr.length; n; i = Math.floor(Math.random() * n), tmp = arr[--n], arr[n] = arr[i], arr[i] = tmp);
              arr = arr.slice(0, random_count);
              var html = '<ul>';
            
              for(var j=0;j<arr.length;j++){
                var item=arr[j];
                html += '<li><strong>' + 
                item.date + ':&nbsp;&nbsp;<a href="' + (site.BASE_URI+item.uri) + '">' + 
                (item.title || item.uri) + '</a></strong>';
                if(item.excerpt){
                  html +='<div class="post-excerpt">'+item.excerpt+'</div>';
                }
                html +='</li>';
                
              }
              $(obj).html(html + '</ul>');
          }
          $('.random_posts_ul').each(function () {
              var c = this;
              if (!site.posts || !site.posts.length){
                  $.getJSON(site.BASE_URI + 'js/posts.js',function(json){site.posts = json;load_random_posts(c)});
              } 
               else{
                load_random_posts(c);
              }
          });
      </script>
    </div>
  </div>

    
<nav id="article-nav">
  
  
    <a href="/2020/03/06/set_session-cannot-be-used/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">set_session cannot be used inside a transaction</div>
    </a>
  
</nav>

  
</article>
 
     
  <div class="comments" id="comments">
    
     
    <section id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a>
        </noscript>
      </div>
      </section>
      
       
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
       
      
      
  </div>
 
  

</section>
           
    <aside id="sidebar">
  
    

  
    
    <div class="widget-wrap">
    
      <div class="widget" id="toc-widget-fixed">
      
        <strong class="toc-title">Content</strong>
        <div class="toc-widget-list">
              <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Modules-that-JVM-has"><span class="toc-number">1.</span> <span class="toc-text">Modules that JVM has</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ClassLoader"><span class="toc-number">1.1.</span> <span class="toc-text">ClassLoader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Runtime-Data-Areas"><span class="toc-number">1.2.</span> <span class="toc-text">Runtime Data Areas</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Class-Method-Area"><span class="toc-number">1.2.1.</span> <span class="toc-text">Class(Method) Area</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Heap"><span class="toc-number">1.2.2.</span> <span class="toc-text">Heap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Stack"><span class="toc-number">1.2.3.</span> <span class="toc-text">Stack</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PC-Program-Counter-Regiser"><span class="toc-number">1.2.4.</span> <span class="toc-text">PC(Program Counter) Regiser</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Native-Method-Stack"><span class="toc-number">1.2.5.</span> <span class="toc-text">Native Method Stack</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Execution-Engine"><span class="toc-number">1.3.</span> <span class="toc-text">Execution Engine</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Garbage-Collection"><span class="toc-number">1.3.1.</span> <span class="toc-text">Garbage Collection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Young-Generation"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">Young Generation</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Old-Generation"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">Old Generation</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Garbage-Collection-Algorithms"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">Garbage Collection Algorithms</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#serial-collector"><span class="toc-number">1.3.1.3.1.</span> <span class="toc-text">serial collector</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Parallel-collector"><span class="toc-number">1.3.1.3.2.</span> <span class="toc-text">Parallel collector</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Concurrent-collector"><span class="toc-number">1.3.1.3.3.</span> <span class="toc-text">Concurrent collector</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Native-Method-Interface-JNI-Java-Native-Interface"><span class="toc-number">1.4.</span> <span class="toc-text">Native Method Interface (JNI - Java Native Interface)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Native-Method-Libraries"><span class="toc-number">1.5.</span> <span class="toc-text">Native Method Libraries</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-number">2.</span> <span class="toc-text">References</span></a></li></ol>
          </div>
      </div>
    </div>

  
    

  
    
  
    
  
    

  
</aside>

      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-left">
      &copy; 2014 - 2020 Roy Jia&nbsp;|&nbsp;
      Theme by <a href="https://github.com/giscafer/hexo-theme-cafe/" target="_blank">Cafe</a>
    </div>
     <div id="footer-right">
      Contact&nbsp;|&nbsp;roy.jia@outlook.com
    </div>
  </div>
</footer>
 
<script src="/jquery/jquery.min.js"></script>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">HomePage</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    <img class="back-to-top-btn" src="/images/fly-to-top.png"/>
<script>
// Elevator script included on the page, already.
window.onload = function() {
  var elevator = new Elevator({
    selector:'.back-to-top-btn',
    element: document.querySelector('.back-to-top-btn'),
    duration: 1000 // milliseconds
  });
}
</script>
      

<script>
  var disqus_shortname = 'jjuina';
  
  var disqus_url = 'https://jjuina.com/2020/04/20/JVM/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>







<!-- author:forvoid begin -->
<!-- author:forvoid begin -->

<!-- author:forvoid end -->

<!-- author:forvoid end -->


  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      })
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      })
    </script>
    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


 
<script src="/js/is.js"></script>



  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


<script src="/js/elevator.js"></script>

  </div>
</body>
</html>